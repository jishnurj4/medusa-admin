var Le=Object.create;var C=Object.defineProperty;var Ne=Object.getOwnPropertyDescriptor;var Ve=Object.getOwnPropertyNames;var Ue=Object.getPrototypeOf,Oe=Object.prototype.hasOwnProperty;var s=(e,t)=>C(e,"name",{value:t,configurable:!0});var Me=(e,t)=>{for(var o in t)C(e,o,{get:t[o],enumerable:!0})},ce=(e,t,o,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Ve(t))!Oe.call(e,n)&&n!==o&&C(e,n,{get:()=>t[n],enumerable:!(r=Ne(t,n))||r.enumerable});return e};var d=(e,t,o)=>(o=e!=null?Le(Ue(e)):{},ce(t||!e||!e.__esModule?C(o,"default",{value:e,enumerable:!0}):o,e)),ze=e=>ce(C({},"__esModule",{value:!0}),e);var st={};Me(st,{ALIASED_PACKAGES:()=>z,build:()=>oe,clean:()=>ae,develop:()=>le,findAllValidRoutes:()=>D,findAllValidSettings:()=>j,findAllValidWidgets:()=>P,forbiddenRoutes:()=>R,injectionZones:()=>L,logger:()=>l,normalizePath:()=>w,withCustomWebpackConfig:()=>re});module.exports=ze(st);var R=["/products","/products/:id","/product-categories","/product-categories","/orders","/orders/:id","/customers","/customers/:id","/customers/groups","/customers/groups/:id","/discounts","/discounts/new","/discounts/:id","/gift-cards","/gift-cards/:id","/gift-cards/manage","/pricing","/pricing/new","/pricing/:id","/inventory","/collections","/collections/:id","/draft-orders","/draft-orders/:id","/login","/sales-channels","/publishable-api-keys","/oauth","/oauth/:app_name"];var L=["order.details.before","order.details.after","order.list.before","order.list.after","draft_order.list.before","draft_order.list.after","draft_order.details.before","draft_order.details.after","customer.details.before","customer.details.after","customer.list.before","customer.list.after","customer_group.details.before","customer_group.details.after","customer_group.list.before","customer_group.list.after","product.details.before","product.details.after","product.list.before","product.list.after","product_collection.details.before","product_collection.details.after","product_collection.list.before","product_collection.list.after","price_list.details.before","price_list.details.after","price_list.list.before","price_list.list.after","discount.details.before","discount.details.after","discount.list.before","discount.list.after","gift_card.details.before","gift_card.details.after","gift_card.list.before","gift_card.list.after","custom_gift_card.before","custom_gift_card.after","login.before","login.after"];var H=d(require("path")),De=d(require("webpack"));var ge=d(require("fs-extra")),M=d(require("path"));var K=d(require("fs-extra"));function N(e){return!(K.default.lstatSync(e).isDirectory()&&e.includes("__test__")||K.default.lstatSync(e).isFile()&&(e.includes(".test")||e.includes(".spec")||e.includes("webpack.config")))}s(N,"copyFilter");var E=d(require("fs-extra")),m=d(require("path")),I=d(require("ts-dedent"));var b=d(require("picocolors")),B=d(require("readline"));var q="[@medusajs/admin]";function Ge(){let e=process.stdout.rows-2,t=e>0?`
`.repeat(e):"";console.log(t),B.default.cursorTo(process.stdout,0,0),B.default.clearScreenDown(process.stdout)}s(Ge,"clearScreen");var He=process.stdout.isTTY&&!process.env.CI,Ke=He?Ge:()=>{};function qe(){let e=s((t,o,r)=>{let n=t==="info"?"log":t,a=s(()=>{let i=t==="info"?b.default.cyan(b.default.bold(q)):t==="warn"?b.default.yellow(b.default.bold(q)):b.default.red(b.default.bold(q));return`${b.default.dim(new Date().toLocaleTimeString())} ${i} ${o}`},"format");r!=null&&r.clearScreen&&Ke(),console[n](a()),r!=null&&r.error&&console.error(r.error)},"output");return{info:(t,o)=>e("info",t,o),warn:(t,o)=>e("warn",t,o),error:(t,o)=>e("error",t,o),panic:(t,o)=>{e("error",t,o),e("error","Exiting process",{}),process.exit(1)}}}s(qe,"createLogger");var l=qe();function w(e){let o=process.platform==="win32"?"\\":"/",r=new RegExp(`\\${o}`,"g");return e.replace(r,"/")}s(w,"normalizePath");var V=require("@babel/parser"),_=d(require("@babel/traverse")),v=d(require("fs-extra")),A=d(require("path"));function de(e){return L.includes(e)}s(de,"isValidInjectionZone");function Be(e){let t=e.find(r=>r.type==="ObjectProperty"&&r.key.type==="Identifier"&&r.key.name==="zone");if(!t)return!1;let o=!1;return t.value.type==="StringLiteral"?o=de(t.value.value):t.value.type==="ArrayExpression"&&(o=t.value.elements.every(r=>r.type==="StringLiteral"&&de(r.value))),o}s(Be,"validateWidgetConfigExport");function Je(e){let t=e.find(n=>n.type==="ObjectProperty"&&n.key.type==="Identifier"&&n.key.name==="link");if(!t)return!0;let o=t.value,r=!1;return o.properties.some(n=>n.type==="ObjectProperty"&&n.key.type==="Identifier"&&n.key.name==="label"&&n.value.type==="StringLiteral")&&(r=!0),r}s(Je,"validateRouteConfigExport");function Xe(e){let t=e.find(a=>a.type==="ObjectProperty"&&a.key.type==="Identifier"&&a.key.name==="card");if(!t)return!1;let o=t.value,r=!1,n=!1;return o.properties.some(a=>a.type==="ObjectProperty"&&a.key.type==="Identifier"&&a.key.name==="label"&&a.value.type==="StringLiteral")&&(r=!0),o.properties.some(a=>a.type==="ObjectProperty"&&a.key.type==="Identifier"&&a.key.name==="description"&&a.value.type==="StringLiteral")&&(n=!0),r&&n}s(Xe,"validateSettingConfigExport");function J(e,t){let o=!1,r=e.node.declaration;if(r&&r.type==="VariableDeclaration"){let n=r.declarations.find(a=>a.type==="VariableDeclarator"&&a.id.type==="Identifier"&&a.id.name==="config");if(n&&n.init.type==="ObjectExpression"){let a=n.init.properties;t==="widget"&&(o=Be(a)),t==="route"&&(o=Je(a)),t==="setting"&&(o=Xe(a))}else o=!1}return o}s(J,"validateConfigExport");function X(e,t){let o=!1,r=e.node.declaration;if(r&&(r.type==="Identifier"||r.type==="FunctionDeclaration")){let n=r.type==="Identifier"?r.name:r.id&&r.id.name;if(n)try{(0,_.default)(t,{VariableDeclarator({node:a,scope:i}){let f=!1;a.id.type==="Identifier"&&a.id.name===n&&(f=!0),f&&(0,_.default)(a,{ReturnStatement(u){var p,c;(((p=u.node.argument)==null?void 0:p.type)==="JSXElement"||((c=u.node.argument)==null?void 0:c.type)==="JSXFragment")&&(o=!0)}},i)}})}catch(a){return l.error(`There was an error while validating the default export of ${e}. The following error must be resolved before continuing:`,{error:a}),!1}}return o}s(X,"validateDefaultExport");async function fe(e){let t=await v.default.readFile(e,"utf-8"),o={sourceType:"module",plugins:["jsx"]};(e.endsWith(".ts")||e.endsWith(".tsx"))&&o.plugins.push("typescript");let r;try{r=(0,V.parse)(t,o)}catch(i){return l.error(`An error occurred while parsing the Widget "${e}", and the Widget cannot be injected. The following error must be resolved before continuing:`,{error:i}),!1}let n=!1,a=!1;try{(0,_.default)(r,{ExportDefaultDeclaration:i=>{a=X(i,r)},ExportNamedDeclaration:i=>{n=J(i,"widget")}})}catch(i){return l.error(`An error occurred while validating the Widget "${e}". The following error must be resolved before continuing:`,{error:i}),!1}return n&&!a&&(a||l.error(`The default export in the Widget "${e}" is invalid and the widget will not be injected. Please make sure that the default export is a valid React component.`)),!n&&a&&l.error(`The Widget config export in "${e}" is invalid and the Widget cannot be injected. Please ensure that the config is valid.`),n&&a}s(fe,"validateWidget");function ue(e){let t=w(e),o=/\[(.*?)\]/g;return t.replace(o,":$1").replace(/\/page\.[jt]sx?$/i,"")}s(ue,"createPath");function Ze(e){return R.includes(e)}s(Ze,"isForbiddenRoute");function pe(e,t){if(Ze(e))return{error:`A route from ${t} is using a forbidden path: ${e}.`,valid:!1};let o=["/",":","-"];for(let r=0;r<e.length;r++){let n=e[r];if(!o.includes(n)&&!/^[a-z0-9]$/i.test(n))return{error:`A route from ${t} is using an invalid path: ${e}. Only alphanumeric characters, "/", ":", and "-" are allowed.`,valid:!1};if(n===":"&&(r===0||e[r-1]!=="/"))return{error:`A route from ${t} is using an invalid path: ${e}. All dynamic segments must be preceded by a "/".`,valid:!1}}return{valid:!0,error:""}}s(pe,"validatePath");async function me(e,t){let o=ue(e.replace(t,"")),{valid:r,error:n}=pe(o,e);if(!r)return l.error(`The path ${o} for the UI Route "${e}" is invalid and the route cannot be injected. The following error must be fixed before the route can be injected: ${n}`),null;let a=await v.default.readFile(e,"utf-8"),i=!1,f=!1,u={sourceType:"module",plugins:["jsx"]};(e.endsWith(".ts")||e.endsWith(".tsx"))&&u.plugins.push("typescript");let p;try{p=(0,V.parse)(a,u)}catch(c){return l.error(`An error occurred while parsing the UI Route "${e}", and the UI Route cannot be injected. The following error must be resolved before continuing:`,{error:c}),null}try{(0,_.default)(p,{ExportDefaultDeclaration:c=>{i=X(c,p)},ExportNamedDeclaration:c=>{f=J(c,"route")}})}catch(c){return l.error(`An error occurred while validating the UI Route "${e}", and the UI Route cannot be injected. The following error must be resolved before continuing:`,{error:c}),null}return i?{path:o,hasConfig:f,file:e}:(l.error(`The default export in the UI Route "${e}" is invalid and the route cannot be injected. Please make sure that the default export is a valid React component.`),null)}s(me,"validateRoute");async function he(e,t){let o=ue(e.replace(t,"")),{valid:r,error:n}=pe(o,e);if(!r)return l.error(`The path ${o} for the Setting "${e}" is invalid and the setting cannot be injected. The following error must be fixed before the Setting can be injected: ${n}`),null;let a=await v.default.readFile(e,"utf-8"),i=!1,f=!1,u={sourceType:"module",plugins:["jsx"]};(e.endsWith(".ts")||e.endsWith(".tsx"))&&u.plugins.push("typescript");let p;try{p=(0,V.parse)(a,u)}catch(c){return l.error(`
      An error occured while parsing the Setting "${e}". The following error must be resolved before continuing:
      `,{error:c}),null}try{(0,_.default)(p,{ExportDefaultDeclaration:c=>{i=X(c,p)},ExportNamedDeclaration:c=>{f=J(c,"setting")}})}catch(c){return l.error(`
      An error occured while validating the Setting "${e}". The following error must be resolved before continuing:`,{error:c}),null}return i?f?{path:o,file:e}:(l.error(`The named export "config" in the Setting "${e}" is invalid or missing and the settings page will not be injected. Please make sure that the file exports a valid config.`),null):(l.error(`The default export in the Setting "${e}" is invalid and the page will not be injected. Please make sure that the default export is a valid React component.`),null)}s(he,"validateSetting");async function j(e){let t=[];if(!await v.default.pathExists(e))return[];let r=await v.default.readdir(e),n=!1;for(let i of r){let f=A.default.join(e,i);if((await v.default.stat(f)).isDirectory()){let p=await v.default.readdir(f);for(let c of p){let y=A.default.join(e,i,c),$=await v.default.stat(y);if($.isFile()&&/^(.*\/)?page\.[jt]sx?$/i.test(c)){t.push(y);break}else $.isDirectory()&&(n=!0)}}}return n&&l.warn(`The directory ${e} contains subdirectories. Settings do not support nested routes, only UI Routes support nested paths.`),(await Promise.all(t.map(async i=>he(i,e)))).filter(i=>i!==null)}s(j,"findAllValidSettings");async function P(e){let t=[];if(!await v.default.pathExists(e))return[];async function r(i){let f=await v.default.readdir(i);for(let u of f){let p=A.default.join(i,u),c=await v.default.stat(p);c.isDirectory()?await r(p):c.isFile()&&/\.(js|jsx|ts|tsx)$/i.test(u)&&t.push(p)}}s(r,"traverseDirectory"),await r(e);let n=t.map(i=>fe(i)?i:null);return(await Promise.all(n)).filter(i=>i!==null)}s(P,"findAllValidWidgets");async function D(e){let t=[];if(!await v.default.pathExists(e))return[];async function r(i){let f=await v.default.readdir(i);for(let u of f){let p=A.default.join(i,u),c=await v.default.stat(p);c.isDirectory()?await r(p):c.isFile()&&/^(.*\/)?page\.[jt]sx?$/i.test(u)&&t.push(p)}}s(r,"traverseDirectory"),await r(e);let n=t.map(async i=>me(i,e));return(await Promise.all(n)).filter(i=>i!==null)}s(D,"findAllValidRoutes");var U=/\.[^/.]+$/;async function Qe(e,t){if(process.env.PLUGIN_ADMIN_UI_SKIP_CACHE)return!0;try{await E.default.copy(e,t,{filter:N})}catch(o){return l.error("Could not copy local extensions to cache folder. See the error below for details:",{error:o}),!1}return!0}s(Qe,"copyLocalExtensions");async function Ye(e,t){let o=m.default.resolve(e,"src","admin");if(!await E.default.pathExists(o))return!1;if(!await Qe(o,m.default.resolve(t,"admin","src","extensions")))return l.error("Could not copy local extensions to cache folder. See above error for details. The error must be fixed before any local extensions can be injected."),!1;let[a,i,f]=await Promise.all([P(m.default.resolve(t,"admin","src","extensions","widgets")),D(m.default.resolve(t,"admin","src","extensions","routes")),j(m.default.resolve(t,"admin","src","extensions","settings"))]),u=a.map((h,g)=>{let x=w(m.default.relative(m.default.resolve(t,"admin","src","extensions"),h).replace(U,""));return{importStatement:`import Widget${g}, { config as widgetConfig${g} } from "./${x}"`,extension:`{ Component: Widget${g}, config: { ...widgetConfig${g}, type: "widget" } }`}}),p=i.map((h,g)=>{let x=w(m.default.relative(m.default.resolve(t,"admin","src","extensions"),h.file).replace(U,"")),Te=h.hasConfig?`import Page${g}, { config as routeConfig${g} } from "./${x}"`:`import Page${g} from "./${x}"`,Re=h.hasConfig?`{ Component: Page${g}, config: { ...routeConfig${g}, type: "route",  path: "${h.path}" } }`:`{ Component: Page${g}, config: { path: "${h.path}", type: "route" } }`;return{importStatement:Te,extension:Re}}),c=f.map((h,g)=>{let x=w(m.default.relative(m.default.resolve(t,"admin","src","extensions"),h.file).replace(U,""));return{importStatement:`import Setting${g}, { config as settingConfig${g} } from "./${x}"`,extension:`{ Component: Setting${g}, config: { ...settingConfig${g}, path: "${h.path}", type: "setting" } }`}}),y=[...u,...p,...c],$=I.default`
    ${y.map(h=>h.importStatement).join(`
`)}

    const LocalEntry = {
      identifier: "local",
      extensions: [
        ${y.map(h=>h.extension).join(`,
`)}
      ],
    }

    export default LocalEntry
  `;try{await E.default.outputFile(m.default.resolve(t,"admin","src","extensions","_local-entry.ts"),$)}catch(h){l.panic("Failed to write the entry file for the local extensions. See the error below for details:",{error:h})}return!0}s(Ye,"createLocalExtensionsEntry");function et(e){let t=[];for(let o of e)try{let r=m.default.dirname(require.resolve(`${o}/package.json`,{paths:[process.cwd()]})),n=m.default.resolve(r,"dist","admin","_virtual_entry.js");E.default.existsSync(n)&&t.push(n)}catch{l.warn(`There was an error while attempting to load extensions from the plugin: ${o}. Are you sure it is installed?`)}return t}s(et,"findPluginsWithExtensions");async function tt(e,t){let o=I.default`
    const path = require("path")

    const devPath = path.join(__dirname, "..", "..", "src/admin/**/*.{js,jsx,ts,tsx}")

    module.exports = {
      content: [
        devPath,
        ${t.map(r=>`"${w(m.default.relative(m.default.resolve(e,"admin"),m.default.dirname(m.default.join(r,"..",".."))))}/dist/admin/**/*.{js,jsx,ts,tsx}"`).join(`,
`)}
      ],
    }
  
  `;try{await E.default.outputFile(m.default.resolve(e,"admin","tailwind.content.js"),o)}catch{l.warn(`Failed to write the Tailwind content file to ${e}. The admin UI will remain functional, but CSS classes applied to extensions from plugins might not have the correct styles`)}}s(tt,"writeTailwindContentFile");async function rt(e,t,o){if(!t.length&&!o){let i=I.default`
      const extensions = []

      export default extensions
    `;try{await E.default.outputFile(m.default.resolve(e,"admin","src","extensions","_main-entry.ts"),i)}catch(f){l.panic("Failed to write the entry file for the main extensions. See the error below for details:",{error:f})}return}let n=[...t.map(i=>w(m.default.relative(m.default.resolve(e,"admin","src","extensions"),i).replace(U,""))).map((i,f)=>({importStatement:`import Plugin${f} from "${i}"`,extension:`Plugin${f}`})),...o?[{importStatement:'import LocalEntry from "./_local-entry"',extension:"LocalEntry"}]:[]],a=I.default`
      ${n.map(i=>i.importStatement).join(`
`)}

      const extensions = [
        ${n.map(i=>i.extension).join(`,
`)}
      ]

      export default extensions
    `;try{await E.default.outputFile(m.default.resolve(e,"admin","src","extensions","_main-entry.ts"),a)}catch(i){l.panic("Failed to write the extensions entry file. See the error below for details:",{error:i})}}s(rt,"createMainExtensionsEntry");async function O({appDir:e,dest:t,plugins:o}){let r=await Ye(e,t),n=et(o);await rt(t,n,r),await tt(t,n)}s(O,"createEntry");async function ot(e){if(process.env.PLUGIN_ADMIN_UI_SKIP_CACHE)return!0;let t=M.default.resolve(__dirname,"..","ui"),o=M.default.resolve(e,"admin");try{await ge.default.copy(t,o,{filter:N})}catch(r){l.panic(`Could not copy the admin UI to ${o}. See the error below for details:`,{error:r})}}s(ot,"copyAdmin");async function W({appDir:e,plugins:t}){let o=M.default.resolve(e,".cache");return await ot(o),await O({appDir:e,dest:o,plugins:t}),{cacheDir:o}}s(W,"createCacheDir");var Z=d(require("dotenv")),ve=d(require("fs-extra")),Q=d(require("path"));var nt=/^MEDUSA_ADMIN_/i,S="";switch(process.env.NODE_ENV){case"production":S=".env.production";break;case"staging":S=".env.staging";break;case"test":S=".env.test";break;case"development":default:S=".env";break}ve.default.existsSync(S)?Z.default.config({path:Q.default.resolve(process.cwd(),S)}):S!==".env"&&Z.default.config({path:Q.default.resolve(process.cwd(),".env")});var Y=s(e=>{let t=Object.keys(process.env).filter(r=>nt.test(r)).reduce((r,n)=>(r[n]=process.env[n],r),{ADMIN_PATH:e.path||"/",NODE_ENV:e.env||"development",MEDUSA_BACKEND_URL:e.backend||process.env.MEDUSA_BACKEND_URL});return{"process.env":Object.keys(t).reduce((r,n)=>(r[n]=JSON.stringify(t[n]),r),{})}},"getClientEnv");var ye=d(require("chokidar")),we=d(require("fs-extra")),k=d(require("path"));async function ee(e,t,o){let r=k.default.resolve(e,"src","admin"),n=ye.default.watch(r,{ignored:/(^|[/\\])\../,ignoreInitial:!0});n.on("all",async(a,i)=>{(a==="unlinkDir"||a==="unlink")&&it(i,e,t),await O({appDir:e,dest:t,plugins:o}),l.info("Extensions cache directory was re-initialized")}),process.on("SIGINT",async()=>{await n.close()}).on("SIGTERM",async()=>{await n.close()})}s(ee,"watchLocalAdminFolder");function it(e,t,o){let r=k.default.resolve(t,"src","admin"),n=k.default.relative(r,e),a=k.default.resolve(o,"admin","src","extensions"),i=k.default.resolve(a,n);try{we.default.removeSync(i)}catch(f){l.error(`An error occurred while removing ${i}: ${f}`)}}s(it,"removeUnlinkedFile");var Ae=d(require("fs-extra")),je=d(require("path")),Pe=d(require("webpack"));function xe(e){let{options:t}=e;t.path&&(t.path.startsWith("/")||l.panic("'path' in the options of `@medusajs/admin` must start with a '/'"),t.path!=="/"&&t.path.endsWith("/")&&l.panic("'path' in the options of `@medusajs/admin` cannot end with a '/'"),typeof t.path!="string"&&l.panic("'path' in the options of `@medusajs/admin` must be a string"))}s(xe,"validateArgs");var Ee=d(require("@pmmmwh/react-refresh-webpack-plugin")),$e=d(require("copy-webpack-plugin")),Se=d(require("html-webpack-plugin")),G=d(require("mini-css-extract-plugin")),F=d(require("path")),_e=require("swc-minify-webpack-plugin"),ke=d(require("webpack")),Ce=d(require("webpackbar"));var z=["react","react-dom","react-router-dom","react-dnd","react-dnd-html5-backend","react-select","react-helmet-async","@tanstack/react-query","@tanstack/react-table","@emotion/react","medusa-react","@medusajs/ui","@medusajs/icons","@medusajs/ui-preset"];var be=z.reduce((e,t)=>(e[`${t}$`]=require.resolve(t),e),{});function at(e){return e?e==="/"||e.endsWith("/")?e:`${e}/`:"/app/"}s(at,"formatPublicPath");function te({entry:e,dest:t,cacheDir:o,env:r,options:n,template:a,publicFolder:i,reporting:f="fancy"}){let u=r==="production",p=Y({env:r,backend:n==null?void 0:n.backend,path:n==null?void 0:n.path}),c=at(n==null?void 0:n.path),y=u?[new G.default({filename:"[name].[chunkhash].css",chunkFilename:"[name].[chunkhash].css"}),new Ce.default({basic:f==="minimal",fancy:f==="fancy"})]:[new G.default,new Ee.default];return{mode:r,devtool:u?!1:"inline-source-map",entry:[e],output:{path:t,filename:u?"[name].[contenthash:8].js":"[name].bundle.js",chunkFilename:u?"[name].[contenthash:8].chunk.js":"[name].chunk.js"},optimization:{minimize:!0,minimizer:[new _e.SwcMinifyWebpackPlugin],moduleIds:"deterministic",runtimeChunk:!0},module:{rules:[{test:/\.tsx?$/,exclude:/node_modules/,include:[o],use:{loader:"swc-loader",options:{jsc:{parser:{syntax:"typescript",jsx:!0},transform:{react:{runtime:"automatic",development:!u,refresh:!u}}}}}},{test:/\.jsx?$/,exclude:/node_modules/,include:[o],use:{loader:"swc-loader",options:{jsc:{parser:{syntax:"ecmascript",jsx:!0},transform:{react:{runtime:"automatic"}}}}}},{test:/\.css$/,use:[G.default.loader,"css-loader","postcss-loader"]},{test:/\.svg$/,oneOf:[{type:"asset/resource",resourceQuery:/url/},{type:"asset/inline",resourceQuery:/base64/},{issuer:/\.[jt]sx?$/,use:["@svgr/webpack"]}],generator:{filename:`images/${u?"[name]-[hash][ext]":"[name][ext]"}`}},{test:/\.(eot|otf|ttf|woff|woff2)$/,type:"asset/resource"},{test:/\.m?jsx?$/,resolve:{fullySpecified:!1}}]},resolve:{alias:be,symlinks:!1,extensions:[".js",".jsx",".ts",".tsx"],mainFields:["browser","module","main"],modules:["node_modules",F.default.resolve(__dirname,"..","node_modules")],fallback:{readline:!1,path:!1}},plugins:[new Se.default({inject:!0,template:a||F.default.resolve(__dirname,"..","ui","index.html"),publicPath:c}),new ke.default.DefinePlugin(p),new $e.default({patterns:[{from:i||F.default.resolve(__dirname,"..","ui","public"),to:F.default.resolve(t,"public")}]}),...y].filter(Boolean),stats:u?"errors-only":"errors-warnings"}}s(te,"getWebpackConfig");async function T(e,t){xe(t);let o=te(t),r=je.default.join(e,"src","admin","webpack.config.js");if(await Ae.default.pathExists(r)){let a;try{a=require(r)}catch(i){l.panic("An error occured while trying to load your custom Webpack config. See the error below for details:",{error:i})}typeof a=="function"&&(t.devServer&&(o.devServer=t.devServer),o=a(o,Pe.default),o||l.panic("Nothing was returned from your custom webpack configuration"))}return o}s(T,"getCustomWebpackConfig");function re(e){return(t,o)=>e(t,o)}s(re,"withCustomWebpackConfig");async function oe({appDir:e,buildDir:t,plugins:o,options:r,reporting:n="fancy"}){process.env.PLUGIN_ADMIN_UI_SKIP_CACHE||await W({appDir:e,plugins:o});let a=H.default.resolve(e,".cache"),i=H.default.resolve(a,"admin","src","main.tsx"),f=H.default.resolve(e,t),p=await T(e,{entry:i,dest:f,cacheDir:a,env:"production",options:r,reporting:n}),c=(0,De.default)(p);return new Promise((y,$)=>{c.run((h,g)=>{h&&(h.details&&l.error(h.details),$(h));let x=g.toJson();return g.hasErrors()&&l.error(JSON.stringify(x.errors)),y({stats:g,warnings:x.warnings})})})}s(oe,"build");var ne=d(require("fs-extra")),ie=d(require("path"));async function ae({appDir:e,outDir:t}){let o=ie.default.resolve(e,".cache","admin"),r=ie.default.resolve(e,t);await ne.default.remove(r),await ne.default.remove(o)}s(ae,"clean");var se=d(require("path")),Ie=d(require("react-dev-utils/openBrowser")),We=d(require("webpack")),Fe=d(require("webpack-dev-server"));async function le({appDir:e,buildDir:t,plugins:o,options:r={path:"/",backend:"http://localhost:9000",develop:{open:!0,port:7001,host:"localhost",logLevel:"error",stats:"normal",allowedHosts:"auto"}}}){let{cacheDir:n}=await W({appDir:e,plugins:o}),a=se.default.resolve(n,"admin","src","main.tsx"),i=se.default.resolve(e,t),u=await T(e,{entry:a,dest:i,cacheDir:n,env:"development",options:r}),p=(0,We.default)({...u,infrastructureLogging:{level:r.develop.logLevel},stats:r.develop.stats==="normal"?"errors-only":void 0}),c={port:r.develop.port,host:r.develop.host,client:{logging:"none",overlay:{errors:!0,warnings:!1},webSocketURL:r.develop.webSocketURL?r.develop.webSocketURL:`ws://${r.develop.host}:${r.develop.port}/ws`},open:!1,onListening:r.develop.open?function(h){h||l.warn("Failed to open browser."),(0,Ie.default)(`http://${r.develop.host}:${r.develop.port}${r.path?r.path:""}`)}:void 0,devMiddleware:{publicPath:r.path,stats:r.develop.stats==="normal"?!1:void 0},historyApiFallback:{index:r.path,disableDotRule:!0},hot:!0,allowedHosts:r.develop.allowedHosts?r.develop.allowedHosts:"auto"},y=new Fe.default(c,p);await s(async()=>{l.info(`Started development server on http://${r.develop.host}:${r.develop.port}${r.path?r.path:""}`),await y.start()},"runServer")(),await ee(e,n,o)}s(le,"develop");0&&(module.exports={ALIASED_PACKAGES,build,clean,develop,findAllValidRoutes,findAllValidSettings,findAllValidWidgets,forbiddenRoutes,injectionZones,logger,normalizePath,withCustomWebpackConfig});
//# sourceMappingURL=index.js.map